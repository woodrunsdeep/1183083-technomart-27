var feedbackLink=document.querySelector(".contact__button"),feedbackForm=document.querySelector(".feedback-form"),cart=document.querySelector(".user-navigation__button--cart"),itemsCounter=document.getElementById("itemsCounter"),bookmarks=document.getElementById("bookmarksQuantity"),bookmarksButtons=Array.prototype.slice.call(document.querySelectorAll(".button--bookmark")),mapLink=document.querySelector(".map__link"),modalMap=document.querySelector(".modal-map"),modals=Array.prototype.slice.call(document.querySelectorAll(".modal")),buttons=Array.prototype.slice.call(document.querySelectorAll(".button--to-cart")),added=document.querySelector(".added-to-cart"),modalCheckoutButton=added.querySelector(".modal-checkout"),proceedShopping=added.querySelector(".close-modal-button"),products=Array.prototype.slice.call(document.querySelectorAll(".product"));if(null!==feedbackForm){var username=feedbackForm.querySelector("[name=username]"),email=feedbackForm.querySelector("[name=email]"),message=feedbackForm.querySelector("[name=message]"),isStorageSupport=!0,storage="";try{storage=localStorage.getItem("username")}catch(e){isStorageSupport=!1}}function showBtn(e){var t=e.querySelector(".product__image"),o=Array.prototype.slice.call(e.querySelectorAll(".action-buttons__button")),r=e.querySelector(".action-buttons");o.forEach(function(e){e.addEventListener("focus",function(e){t.classList.add("product__image--hidden"),r.classList.add("action-buttons--show")}),e.addEventListener("blur",function(e){t.classList.remove("product__image--hidden"),r.classList.remove("action-buttons--show")})})}null!==feedbackLink&&feedbackLink.addEventListener("click",function(e){e.preventDefault(),feedbackForm.classList.add("modal-show"),storage?username.value=storage:username.focus()}),null!==feedbackForm&&feedbackForm.addEventListener("submit",function(e){username.value&&email.value&&message.value?isStorageSupport&&localStorage.setItem("username",username.value):(e.preventDefault(),feedbackForm.classList.remove("modal-error"),feedbackForm.offsetWidth=feedbackForm.offsetWidth,feedbackForm.classList.add("modal-error"))}),null!==mapLink&&mapLink.addEventListener("click",function(e){e.preventDefault(),modalMap.classList.add("modal-show")}),modals.forEach(function(t){t.querySelector(".close-button").addEventListener("click",function(e){e.preventDefault(),t.classList.remove("modal-show"),t.classList.remove("modal-error")}),window.addEventListener("keydown",function(e){27===e.keyCode&&(e.preventDefault(),t.classList.contains("modal-show")&&(t.classList.remove("modal-show"),t.classList.remove("modal-error")))})}),buttons.forEach(function(e){e.addEventListener("click",function(){added.classList.add("modal-show"),itemsCounter.innerHTML++,cart.classList.add("user-navigation__button--cart-non-empty"),modalCheckoutButton.focus(),proceedShopping.addEventListener("click",function(e){e.preventDefault(),added.classList.remove("modal-show")}),proceedShopping.addEventListener("keydown",function(e){13!==e.keyCode&&32!==e.keyCode||(e.preventDefault(),added.classList.remove("modal-show"))})})}),bookmarksButtons.forEach(function(e){e.addEventListener("click",function(){bookmarks.innerHTML++})});for(var i=0;i<products.length;i++)showBtn(products[i]);var track=document.querySelector(".carousel__track"),slides=Array.prototype.slice.call(document.querySelectorAll(".carousel__slide")),nextButton=document.querySelector(".carousel__button--next"),prevButton=document.querySelector(".carousel__button--previous"),dotsNav=document.querySelector(".carousel__nav"),dots=Array.prototype.slice.call(document.querySelectorAll(".carousel__indicator")),slideWidth=slides[0].getBoundingClientRect().width,setSlidePosition=function(e,t){e.style.left=slideWidth*t+"px"};function findInd(e,t){for(var o,r=0;r<e.length;++r)if(e[r]==t){o=r;break}return o}Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector),Element.prototype.closest||(Element.prototype.closest=function(e){var t=this;do{if(t.matches(e))return t;t=t.parentElement||t.parentNode}while(null!==t&&1===t.nodeType);return null}),slides.forEach(setSlidePosition);var moveToSlide=function(e,t,o){e.style.transform="translateX(-"+o.style.left+")",t.classList.remove("current-slide"),o.classList.add("current-slide")},updateDots=function(e,t){e.classList.remove("current-slide"),t.classList.add("current-slide")},disableArrows=function(e,t,o,r){0===r?(t.setAttribute("disabled",""),o.removeAttribute("disabled","")):r===e.length-1?(t.removeAttribute("disabled",""),o.setAttribute("disabled","")):(t.removeAttribute("disabled",""),o.removeAttribute("disabled",""))};prevButton.addEventListener("click",function(e){var t=track.querySelector(".current-slide"),o=t.previousElementSibling,r=dotsNav.querySelector(".current-slide"),n=r.previousElementSibling,a=findInd(slides,o);moveToSlide(track,t,o),updateDots(r,n),disableArrows(slides,prevButton,nextButton,a)}),nextButton.addEventListener("click",function(e){var t=track.querySelector(".current-slide"),o=t.nextElementSibling,r=dotsNav.querySelector(".current-slide"),n=r.nextElementSibling,a=findInd(slides,o);moveToSlide(track,t,o),updateDots(r,n),disableArrows(slides,prevButton,nextButton,a)}),dotsNav.addEventListener("click",function(e){var t=e.target.closest("button");if(t){var o=track.querySelector(".current-slide"),r=dotsNav.querySelector(".current-slide"),n=findInd(dots,t),a=slides[n];moveToSlide(track,o,a),updateDots(r,t),disableArrows(slides,prevButton,nextButton,n)}});